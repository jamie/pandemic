%table
  - @grid.each_with_index do |row, y|
    %tr
      - row.each_with_index do |city, x|
        - if city.blank?
          %td &nbsp;
        - else
          %td{class: "city #{city.color}"}
            .players
              - @players.select{|player| player.city == city }.each do |player|
                %br
                - if player.current?
                  %strong= player.role.name
                - else
                  = player.role.name

            %p= link_to city.name, game_actions_path(@game.id, city: city.id), method: :post

            .virus
              - @game.viri.where(city: city).each do |virus|
                = image_tag "#{virus.color}.png"
